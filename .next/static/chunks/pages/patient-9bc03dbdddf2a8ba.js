(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[705],{9307:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/patient",function(){return a(2580)}])},2580:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return PatientPanel}});var n=a(5893),i=a(7294),l=a(1163),o=a(9350);let s={"5901234567890":{name:"Serek Danio truskawkowy",ingredients:["cukier","mleko","aromat","białka mleka"]},"5900000000001":{name:"Pieczywo chrupkie żytnie",ingredients:["żyto","błonnik","s\xf3l"]},"5900000000002":{name:"Baton proteinowy czekoladowy",ingredients:["białko mleka","czekolada","cukier","syrop glukozowy"]},"5900000000003":{name:"Jogurt naturalny 2%",ingredients:["mleko","kultury bakterii"]}};function ProductScanner(e){let{patient:t}=e,[a,l]=(0,i.useState)(""),[o,r]=(0,i.useState)(null),[c,d]=(0,i.useState)(!1),evaluateProduct=async e=>{let a=s[e];if(!a){r("\uD83D\uDD0D Produkt nie został znaleziony w bazie.");return}d(!0),r(null);try{let e=await fetch("/api/evaluate-product",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient:t,product:a})}),n=await e.json();r(n.result||"⚠️ Nie udało się uzyskać odpowiedzi.")}catch(e){console.error(e),r("❌ Wystąpił błąd podczas analizy produktu.")}finally{d(!1)}};return(0,n.jsxs)("div",{className:"bg-white p-6 rounded shadow mt-8",children:[(0,n.jsx)("h2",{className:"text-lg font-bold mb-4",children:"\uD83D\uDED2 Skaner produkt\xf3w (kod EAN)"}),(0,n.jsx)("input",{type:"text",placeholder:"Wpisz lub zeskanuj kod EAN",value:a,onChange:e=>l(e.target.value),className:"w-full border px-2 py-1 mb-4"}),(0,n.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-50",onClick:()=>evaluateProduct(a),disabled:c||!a,children:c?"Analizuję...":"Sprawdź produkt"}),o&&(0,n.jsx)("p",{className:"mt-4 text-md font-semibold",children:o})]})}function PatientPanel(){(0,l.useRouter)();let[e,t]=(0,i.useState)(null),[a,s]=(0,i.useState)(null),[r,c]=(0,i.useState)(""),[d,u]=(0,i.useState)("");return(0,i.useEffect)(()=>{let e=JSON.parse(localStorage.getItem("dietHistory")||"[]");if(e.length>0){let a=e[e.length-1];t(a);let n=new Date,i=new Date(a.expiresAt),l=Math.ceil((i.getTime()-n.getTime())/864e5);s(l)}},[]),(0,n.jsxs)("div",{className:"min-h-screen bg-gray-100 p-6",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"Panel pacjenta"}),null!==a&&(0,n.jsx)("div",{className:"p-3 mb-4 rounded ".concat(a>0?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"),children:a>0?"\uD83D\uDCC5 Masz jeszcze ".concat(a," dni dostępu (").concat((null==e?void 0:e.premium)?"Plan premium":"Plan podstawowy",")"):"⛔ Tw\xf3j dostęp wygasł. Skontaktuj się z administratorem lub opłać dostęp."}),e?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{className:"mb-2 text-sm text-gray-600",children:["Dieta z dnia: ",e.date," | BMI: ",e.bmi," | Zatwierdzona przez: ",e.approvedBy||"—"]}),e.diet.map((e,t)=>(0,n.jsxs)("div",{className:"bg-white p-4 rounded shadow mb-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold",children:e.name}),(0,n.jsx)("ul",{className:"list-disc pl-5 text-sm",children:e.ingredients.map((e,t)=>(0,n.jsxs)("li",{children:[e.product," – ",e.weight," g"]},t))}),(0,n.jsxs)("p",{className:"text-sm mt-1",children:["Kalorie: ",e.calories," kcal | IG: ",e.glycemicIndex]})]},t)),(0,n.jsx)("button",{className:"bg-green-600 text-white px-4 py-2 rounded",onClick:()=>(0,o.s)(e.patient,e.bmi,e.diet),children:"\uD83D\uDCC4 Pobierz dietę jako PDF"}),(0,n.jsxs)("div",{className:"mt-6 bg-white p-4 rounded shadow",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"\uD83D\uDD04 Zmień dietę"}),(0,n.jsxs)("div",{className:"mb-2",children:[(0,n.jsx)("label",{className:"block text-sm font-semibold",children:"Wybierz region"}),(0,n.jsxs)("select",{className:"w-full border px-2 py-1",value:r,onChange:e=>c(e.target.value),children:[(0,n.jsx)("option",{value:"",children:"-- wybierz region --"}),(0,n.jsx)("option",{value:"Polska",children:"Polska"}),(0,n.jsx)("option",{value:"Azja",children:"Azja"}),(0,n.jsx)("option",{value:"Afryka",children:"Afryka"}),(0,n.jsx)("option",{value:"Ameryka",children:"Ameryka"}),(0,n.jsx)("option",{value:"Europa",children:"Europa"})]})]}),(0,n.jsxs)("div",{className:"mb-2",children:[(0,n.jsx)("label",{className:"block text-sm font-semibold",children:"Wybierz kuchnię"}),(0,n.jsxs)("select",{className:"w-full border px-2 py-1",value:d,onChange:e=>u(e.target.value),children:[(0,n.jsx)("option",{value:"",children:"-- wybierz kuchnię --"}),(0,n.jsx)("option",{value:"Japońska",children:"Japońska"}),(0,n.jsx)("option",{value:"Śr\xf3dziemnomorska",children:"Śr\xf3dziemnomorska"}),(0,n.jsx)("option",{value:"Meksykańska",children:"Meksykańska"}),(0,n.jsx)("option",{value:"Francuska",children:"Francuska"}),(0,n.jsx)("option",{value:"Włoska",children:"Włoska"})]})]}),(0,n.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded mt-2",onClick:()=>alert("\uD83E\uDDE0 AI wygeneruje nową dietę dla regionu ".concat(r," i kuchni ").concat(d)),children:"\uD83D\uDD01 Zmień dietę"})]}),e.premium&&(0,n.jsx)(ProductScanner,{patient:e})]}):(0,n.jsx)("p",{children:"Brak zapisanej diety. Skontaktuj się z lekarzem lub dietetykiem."})]})}},9350:function(e,t,a){"use strict";a.d(t,{s:function(){return generateDietPdf}});var n=a(4842);async function generateDietPdf(e,t,i){var l,o;let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4?arguments[4]:void 0,c=(await a.e(270).then(a.t.bind(a,6727,23))).default,d=(await a.e(957).then(a.t.bind(a,7920,23))).default;c.vfs=d.vfs;let u=[{text:"\uD83D\uDCCB Plan żywieniowy pacjenta",style:"header"},{text:"Data: ".concat(new Date().toLocaleString()),margin:[0,0,0,10]},{text:"Dane pacjenta:\nWiek: ".concat(e.age," lat | Płeć: ").concat(e.sex," | Waga: ").concat(e.weight," kg | Wzrost: ").concat(e.height," cm | BMI: ").concat(null!=t?t:"n/a"),margin:[0,0,0,10]},{text:"Schorzenia: ".concat((null===(l=e.conditions)||void 0===l?void 0:l.join(", "))||"brak","\nAlergie: ").concat(e.allergies||"brak","\nRegion: ").concat(e.region||"brak"),margin:[0,0,0,10]},{text:"\uD83E\uDE7A Uwzględnione dane medyczne:",style:"subheader",margin:[0,10,0,4]},...(null!==(o=e.medical)&&void 0!==o?o:[]).flatMap(e=>[{text:"• ".concat(e.condition),bold:!0,margin:[0,4,0,0]},...e.tests.map(e=>({text:"   → ".concat(e.name,": ").concat(e.value||"—"),margin:[0,0,0,2]}))]),{text:"\uD83C\uDF74 Zalecana dieta:",style:"subheader",margin:[0,10,0,6]},...i.map(e=>({table:{widths:["*"],body:[[{text:"\uD83C\uDF7D️ ".concat(e.name),style:"mealTitle"}],[{text:e.ingredients.map(e=>"• ".concat(e.product," – ").concat(e.weight," g")).join("\n")}],[{text:"Kalorie: ".concat(e.calories," kcal | IG: ").concat(e.glycemicIndex),style:"mealInfo"}]]},layout:"lightHorizontalLines",margin:[0,0,0,10]}))];s&&u.push({image:n.y,width:140,alignment:"right",margin:[0,30,0,0]}),u.push({text:"---\n\xa9 ALS sp. z o.o. | KRS 0000087600 | NIP 6252121456 | REGON 266795439\nEmail: a4p.email@gmail.com | tel. +48 500 720 242",style:"footer",margin:[0,30,0,0],alignment:"center"}),c.createPdf({content:u,styles:{header:{fontSize:18,bold:!0,margin:[0,0,0,10]},subheader:{fontSize:14,bold:!0},mealTitle:{bold:!0,fillColor:"#eeeeee"},mealInfo:{italics:!0,fontSize:10,color:"#333333"},footer:{fontSize:9,color:"gray"}},defaultStyle:{fontSize:11},background:r?[{image:r,width:300,opacity:.06,absolutePosition:{x:100,y:200}}]:void 0}).download("dieta_".concat(new Date().toISOString().slice(0,10),".pdf"))}},4842:function(e,t,a){"use strict";a.d(t,{y:function(){return n}});let n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAGQCAYAAACAvzbMAAAgAElEQVR4nO3dWZAdV33n8d8RA0giIiAIiBCLLmiGfVq2vSftX1bV1tt1r92zqmrbrqnt2WV9W/d7qZfZcf/VhEV3RQsMgAcQhAOJw4EdIgghdV9k3nP+/M+Z..."},1163:function(e,t,a){e.exports=a(9974)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=9307)}),_N_E=e.O()}]);